<atz-header></atz-header>

<main #search_wrapper>
    <h1 class="title">Resultado da sua busca por "{{ query }}"</h1>

    <div class="filters">
        <ul class="tabs">
            <li [ngClass]="{ 'active': !opts.tab, 'blocked': (opts.watcheds || opts.toWatchLater) }" (click)="updateOptions({ tab: null })">Todos</li>
            <li [ngClass]="{ 'active': opts.tab === 'c', 'blocked': (opts.watcheds || opts.toWatchLater) }" (click)="updateOptions({ tab: 'c' })">Cursos</li>
            <li [ngClass]="{ 'active': opts.tab === 'm', 'blocked': (opts.watcheds || opts.toWatchLater) }" (click)="updateOptions({ tab: 'm' })">Módulos</li>
            <li [ngClass]="{ 'active': opts.tab === 'l' }" (click)="updateOptions({ tab: 'l' })">Aulas</li>
            <li [ngClass]="{ 'active': opts.tab === 'b', 'blocked': (opts.watcheds || opts.toWatchLater) }" (click)="updateOptions({ tab: 'b' })">Livros</li>
        </ul>

        <div class="toggles">
            <i class="cil-history" [ngClass]="{ 'active': opts.watcheds }" (click)="updateOptions({ watcheds: !opts.watcheds })"></i>
            <i class="cil-clock" [ngClass]="{ 'active': opts.toWatchLater }" (click)="updateOptions({ toWatchLater: !opts.toWatchLater })"></i>
            <i class="cil-star" [ngClass]="{ 'active': opts.favoriteds }" (click)="updateOptions({ favoriteds: !opts.favoriteds })"></i>
        </div>
    </div>

    <section class="featured" *ngIf="featured && featured.length">
        <article *ngFor="let i of featured" [ngClass]="{ 'active': i.wasWatched }" class="card" (click)="goToItem(i)">
            <header>
                <atz-lesson-card class="banner" [image]="i.banner">
                    <p class="lessons">{{ i.lessonsAmount }} aulas</p>
                    <p class="name">{{ i.name }}</p>
                </atz-lesson-card>

                <div class="metadata">
                    <div class="detail">
                        <label>Duração:</label>
                        <p>{{ i.duration | timeduration }} min</p>
                    </div>
                    <div class="detail">
                        <label>Posição:</label>
                        <p>{{ i.position | padstart: 2 }} / {{ i.lessonsAmount }}</p>
                    </div>
                </div>
            </header>

            <div class="info">
                <h2>{{ i.module }}</h2>
                <h1>{{ i.course }}</h1>
                <p>{{ i.teacher }}</p>
            </div>
        </article>
    </section>

    <section class="results">
        <ul class="courses" *ngIf="content.length && opts.tab !== 'b'">
            <li *ngFor="let i of content" [ngClass]="{ 'active': i.wasWatched }" (click)="goToItem(i)">
                <atz-lesson-card class="scale" [width]="20" [image]="i.banner">
                    <div *ngIf="i.amount" class="module-badge">
                        <i class="cil-layers"></i>
                        <span>{{ i.amount | padstart: 2 }}</span>
                    </div>
                </atz-lesson-card>

                <div class="data">
                    <p class="meta">{{ i.label ? i.label : i.module ? '(Módulo)' : '(Curso)' }}</p>
                    <h3 class="name">{{ i.name }}</h3>
                </div>

                <div class="badges">
                    <div class="badge dark" *ngIf="i.duration">{{ i.duration }}</div>
                </div>
            </li>
        </ul>

        <ul class="books" *ngIf="books.length && (opts.tab === 'b' || opts.tab === null)">
            <li *ngFor="let i of books" [ngClass]="{ 'active': i.wasReaded }" (click)="goToBook(i.id)">
                <img [src]="i.cover" class="scale" [title]="i.title + ' - ' + i.author">
                <div>
                    <div class="detail">
                        <label>Páginas:</label>
                        <p>{{ i.pages }} pags</p>
                    </div>
                </div>
            </li>
        </ul>
    </section>

    <section class="emptystate" *ngIf="opts.tab == 'b' && !books.length || (opts.tab == 'l' || opts.tab == null) && !featured.length || (opts.tab == 'c' || opts.tab == 'm') && !content.length ">
        <img src="../../../assets/images/empty_states/search.svg">
        <div>
            <h1>Oops...</h1>
            <p>Parece que ainda não temos nada sobre "{{ query }}" em nosso catálogo. Talvez se você procurar com menos palavras ou algo diferente possamos encontrar o que deseja :)</p>
        </div>
    </section>
</main>